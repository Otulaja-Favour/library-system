<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library Management system</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
    <link rel="stylesheet" href="./style.css">
</head>

<body>

    <!-- signup session -->

    <div class="signupdiv container my-3 border col-12 col-md-8 col-lg-8" id="signupdiv">
        <h1 class="text-center my-3">SIGN UP</h1>
        <label for="fname" class="form-label">First Name</label>
        <input class="form-control form-control-lg" type="text" id="fname" placeholder="First name">
        <div id="fnameval" class="mb-2">
        </div>

        <label for="lname" class="form-label">Last Name</label>
        <input class="form-control form-control-lg" type="text" id="lname" placeholder="last name">
        <div class="   mb-2" id="lnameval">
        </div>

        <label for="email" class="form-label">Email</label>
        <input class="form-control form-control-lg" type="email" id="email" placeholder="Input mail here">
        <div class="   mb-2" id="emailval">
        </div>

        <label for="pswd" class="form-label">Password</label>
        <input class="form-control form-control-lg" type="text" id="pswd" placeholder="Input password Here">
        <div class="   mb-2" id="pasval">
        </div>

        <label for="cpswd" class="form-label">Confirm Password</label>
        <input class="form-control form-control-lg" type="text" id="cpswd" placeholder="Input password Here">
        <div class="   mb-2" id="cpassval">
        </div>

        <button onclick="sign()" class="btn btn-primary my-3 container p-2 ">Signup</button>
        <p class="text-center">if you have an account? <span id="spans"><a href="#" id="login">Login</a></span></p>
    </div>




    <!-- login session -->


    <div id="logindiv" class=" container my-3 border col-12 col-md-8 col-lg-8 ">
        <h1 class="text-center my-3">LOGIN</h1>

        <label for="loginemail" class="form-label">Email</label>
        <input class="form-control form-control-lg" type="email" id="loginemail" placeholder="Input mail here">
        <div class="   mb-2" id="loginemailval">
        </div>

        <label for="loginpswd" class="form-label">Password</label>
        <input class="form-control form-control-lg" type="text" id="loginpswd" placeholder="Input password Here">
        <div class="   mb-2" id="loginpasval">
        </div>

        <button onclick="Login()" class="btn btn-primary my-3 container p-3 ">Login</button>
        <p class="text-center">if you dont have an account? <span id="spans"><a href="#" id="sign">Sign</a></span></p>
    </div>

    <div class="modal fade" id="userInfoModal" tabindex="-1" role="dialog" aria-labelledby="userInfoModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="userInfoModalLabel">Welcome! Please Enter Your Information</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form id="userInfoForm">
                        <div class="form-group">
                            <label for="userName">Name</label>
                            <input type="text" class="form-control" id="userName" placeholder="Enter your name"
                                required>
                        </div>
                        <div class="form-group">
                            <label for="userEmail">Email address</label>
                            <input type="email" class="form-control" id="userEmail" placeholder="Enter your email"
                                required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="saveUserInfo">Save</button>
                </div>
            </div>
        </div>
    </div>



    <!-- membership dashboard -->


    <div id="part2">
        <!-- Navigation Bar -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top">
            <div class="container">
                <a class="navbar-brand animate_animated animatepulse animate_infinite" href="members.html">
                    <i class="bi bi-book"></i> Library
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="#part2">Home</a>
                        </li>
                    </ul>
                    <form class="d-flex" id="userSearchForm">
                        <button class="btn btn-outline-light" type="submit"><a href="./index.html"
                                style="color:  white; text-decoration: none;">Logout</a></button>
                    </form>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="container mt-4">
            <!-- User Profile Card -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <div class="card shadow-sm animate_animated animate_fadeIn">
                        <div class="card-body text-center">
                            <img id="memberimg" src="../image/Download User Profile Icon for free.jpeg"
                                class="rounded-circle mb-3" alt="" style="width: 150px;">
                            <h3 id="userNames"></h3>
                            <button class="btn btn-primary" id="editProfileBtns">Edit Profile</button>
                        </div>
                    </div>
                </div>


<!-- Modal -->
<!-- <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="Profiles">
          ...
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div>
    </div>
  </div> -->


                <div class="col-md-8">
                    <div class="card shadow-sm animate_animated animate_fadeIn">
                        <div class="card-header bg-primary text-white">
                            <h4 class="mb-0">My Library</h4>
                        </div>
                        <div class="card-body">
                            <ul class="nav nav-tabs" id="userLibraryTabs" role="tablist">
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link active" id="borrowed-tab" data-bs-toggle="tab"
                                        data-bs-target="#borrowed" type="button" role="tab">Currently Borrowed <span
                                            class="badge text-bg-secondary ml-2" id="amount">4</span></button>
                                </li>
                                <li class="nav-item" role="presentation">
                                    <button class="nav-link" id="historyBooksContainer" data-bs-toggle="tab"
                                        data-bs-target="#history" type="button" role="tab">Borrowing History<span
                                        class="badge text-bg-secondary ml-2" id="hamount">4</span></button>
                                </li>
                               
                            </ul>
                            <div class="tab-content p-3" id="userLibraryTabContent">
                                <div class="tab-pane fade show active" id="borrowed" role="tabpanel">
                                    <div id="borrowedBooks" class="row">
                                        <!-- Borrowed books will be loaded here -->
                                        <p class="text-center text-muted">You haven't borrowed any books yet.</p>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="history" role="tabpanel">
                                    <div id="historyBooks" class="row">
                                        <!-- History will be loaded here -->
                                        <p class="text-center text-muted">No borrowing history found.</p>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="wishlist" role="tabpanel">
                                    <div id="wishlistBooks" class="row">
                                        <!-- Wishlist will be loaded here -->
                                        <p class="text-center text-muted">Your wishlist is empty.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Search Results Section -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card shadow-sm animate_animated animate_fadeIn">
                        <div
                            class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                            <h4 class="mb-0">Book Catalog</h4>
                            <div class="d-flex">
                                <input class="form-control me-2" type="search" id="userSearchInput"
                                    placeholder="Search books...">

                                <button class="btn btn-light" id="refreshCatalog">
                                    <i class="bi bi-arrow-clockwise"></i>
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row" id="bookCatalog">
                                <!-- Books will be loaded here dynamically -->
                                <div class="d-flex justify-content-center" id="task"
                                    style="display: flex; flex-wrap: wrap;">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>

                                </div>
                            </div>
                            <div class="d-flex justify-content-center mt-4">
                                <!-- <button class="btn btn-primary" id="loadMoreBtn">Load More</button> -->
                                <div id="pagination" style="display: block;"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <div class="toast-container position-fixed top-0 end-0 p-3">
            <div id="bookToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
                <div class="toast-header">
                  
                    <svg class="bd-placeholder-img rounded me-2" width="20" height="20"
                        xmlns="http://www.w3.org/2000/svg" aria-hidden="true" preserveAspectRatio="xMidYMid slice"
                        focusable="false">
                        <rect width="100%" height="100%" fill="#007aff"></rect>
                    </svg>
                    <strong class="me-auto">Your Book</strong>
                    <small class="text-muted">just now</small>
                    <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                </div>
                <div class="toast-body">
                    Book action completed.
                </div>
            </div>
        </div>


        <div class="modal fade" id="userInfoModal" tabindex="-1" role="dialog" aria-labelledby="userInfoModalLabel"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="userInfoModalLabel">Welcome! Please Enter Your Information</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <form id="userInfoForm">
                            <div class="form-group">
                                <label for="userName">Name</label>
                                <input type="text" class="form-control" id="userName" placeholder="Enter your name"
                                    required>
                            </div>
                            <div class="form-group">
                                <label for="userEmail">Email address</label>
                                <input type="email" class="form-control" id="userEmail" placeholder="Enter your email"
                                    required>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary" id="saveUserInfo">Save</button>
                    </div>
                </div>
            </div>
        </div>

    </div>



    <!-- adminstration dashboard -->


    <div id="part3">
        <!-- Navigation Bar -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark sticky-top">
            <div class="container">
                <a class="navbar-brand animate_animated animatepulse animate_infinite" href="#">
                    <i class="bi bi-book"></i> library
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav me-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="./admin.html">Home</a>
                        </li>

                    </ul>
                    <div class="d-flex">
                        <span class="text-light me-3"><i class="bi bi-person-circle"></i> Admin</span>
                        <button class="btn btn-outline-danger" id="logoutBtn"><a href="./index.html">Logout</a></button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="container-fluid mt-4">
            <div class="row">
                <!-- Sidebar -->
                <div class="col-md-3 col-lg-2">
                    <div class="list-group shadow-sm animate_animated animate_fadeIn">
                        <a href="#" class="list-group-item list-group-item-action active" id="dashboardNav">
                            <i class="bi bi-speedometer2"></i> Dashboard
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" id="booksNav">
                            <i class="bi bi-book"></i> Books Management
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" id="membersNav">
                            <i class="bi bi-people"></i> Members Management
                        </a>
                        <a href="#" class="list-group-item list-group-item-action" id="borrowingsNav">
                            <i class="bi bi-arrow-left-right"></i> Borrowings
                        </a>

                        <a href="#" class="list-group-item list-group-item-action" id="settingsNav">
                            <i class="bi bi-gear"></i> Settings
                        </a>
                    </div>
                </div>

                <!-- Main Panel -->
                <div class="col-md-9 col-lg-10 my-2">
                    <!-- Dashboard Section -->
                    <div id="dashboardSection" class="animate_animated animate_fadeIn">
                        <div class="row">
                            <div class="col-12">
                                <h2 class="border-bottom pb-2 mb-4">Dashboard</h2>
                            </div>
                        </div>
                        <div class="row mb-4 my-2">
                            <div class="col-md-3">
                                <div class="card bg-primary text-white shadow-sm">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <h6 class="card-title">Total Books</h6>
                                                <h2 class="card-text" id="totalBooks">15</h2>
                                            </div>
                                            <i class="bi bi-book fs-1"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 my-2">
                                <div class="card bg-success text-white shadow-sm">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <h6 class="card-title">Members</h6>
                                                <h2 class="card-text" id="totalMembers">376</h2>
                                            </div>
                                            <i class="bi bi-people fs-1"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 my-2">
                                <div class="card bg-warning text-dark shadow-sm">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <h6 class="card-title">Books Borrowed</h6>
                                                <h2 class="card-text" id="booksBorrowed">89</h2>
                                            </div>
                                            <i class="bi bi-arrow-right-circle fs-1"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="card bg-danger text-white shadow-sm">
                                    <div class="card-body">
                                        <div class="d-flex justify-content-between align-items-center">
                                            <div>
                                                <h6 class="card-title">Active users</h6>
                                                <h2 class="card-text" id="activedueBooks">12</h2>
                                            </div>
                                            <i class="bi bi-exclamation-circle fs-1"></i>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12">
                                <div class="card shadow-sm mb-4">
                                    <div class="card-header bg-light">
                                        <h5 class="card-title mb-0">Recent Activities</h5>
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive">
                                            <table class="table table-hover">
                                                <thead>
                                                    <tr>
                                                        <th>Date</th>
                                                        <th>Member</th>
                                                        <th>Email</th>
                                                        <th>Details</th>
                                                        <th>Borrowed Books</th>

                                                    </tr>
                                                </thead>
                                                <tbody id="recentActivities" style="overflow: scroll;">
                                                    <!-- Activities will be loaded here -->
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- <div class="col-md-4">
                                <div class="card shadow-sm mb-4">
                                    <div class="card-header bg-light">
                                        <h5 class="card-title mb-0">Popular Books</h5>
                                    </div>
                                    <div class="card-body">
                                        <ul class="list-group list-group-flush" id="popularBooks">
                                             Popular books will be loaded here -->
                                        <!-- </ul>
                                    </div>
                                </div>
                            </div>  -->
                        </div>
                    </div>

                    <!-- Books Management Section -->
                    <div id="booksSection" class=" animate_animated animate_fadeIn d-none" >
                        <div class="row mb-4">
                            <div class="col-md-8">
                                <h2 class="border-bottom pb-2">Books Management</h2>
                            </div>
                            
                        </div>

                        <div class="card shadow-sm">
                            <div class="card-body">
                               

                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Title</th>
                                                <th>Author</th>
                                                <th>Category</th>
                                                <th>Status</th>
                                                <th>Copies</th>
                                            </tr>
                                        </thead>
                                        <tbody id="booksTableBody">
                                            <!-- Books will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>

                                <nav aria-label="Books pagination">
                                    <ul class="pagination justify-content-center" id="booksPagination">
                                        <!-- Pagination will be generated here -->
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>

                    <!-- Members Management Section -->
                    <div id="membersSection" class=" animate_animated animate_fadeIn d-none">
                        <div class="row mb-4">
                            <div class="col-md-8">
                                <h2 class="border-bottom pb-2">Members Management</h2>
                            </div>
                           
                        </div>

                        <div class="card shadow-sm">
                            <div class="card-body">
                                

                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Date</th>
                                                <th>Member</th>
                                                <th>Email</th>
                                                <th>Online</th>
                                                <th>Details</th>
                                                <th>Borrowed Books</th>
                                            </tr>
                                        </thead>
                                        <tbody id="membersTableBody">
                                            <!-- Members will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>

                                <nav aria-label="Members pagination">
                                    <ul class="pagination justify-content-center" id="membersPagination">
                                        <!-- Pagination will be generated here -->
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>

                    <!-- Borrowings Management Section -->
                    <div id="borrowingsSection" class=" animate_animated animate_fadeIn d-none">
                        <div class="row mb-4">
                            <div class="col-md-8">
                                <h2 class="border-bottom pb-2">Borrowings Management</h2>
                            </div>
                           
                        </div>

                        <div class="card shadow-sm">
                            <div class="card-body">
                              

                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Member</th>
                                                <th>Title</th>
                                                <th>Author</th>
                                                <th>Borrow Date</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="borrowingsTableBody">
                                            <!-- Borrowings will be loaded here -->
                                        </tbody>
                                    </table>
                                </div>

                                <nav aria-label="Borrowings pagination">
                                    <ul class="pagination justify-content-center" id="borrowingsPagination">
                                        <!-- Pagination will be generated here -->
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Section -->
                    <div id="settingsSection" class=" animate_animated animate_fadeIn d-none">
                        <h2 class="border-bottom pb-2 mb-4">Settings</h2>

                        <div class="row">


                            <div class="col-md-9">
                                <!-- General Settings Panel -->
                                <div class="card shadow-sm mb-4" id="generalSettings">
                                    <div class="card-header bg-light">
                                        <h5 class="card-title mb-0">General Settings</h5>
                                    </div>
                                    <div class="card-body">
                                        <form id="generalSettingsForm">
                                            <div class="mb-3">
                                                <label for="libraryName" class="form-label">Library Name</label>
                                                <input type="text" class="form-control" id="libraryName" value="">
                                            </div>
                                            <div class="mb-3">
                                                <label for="contactEmail" class="form-label">Contact Email</label>
                                                <input type="email" class="form-control" id="contactEmail" value="">
                                            </div>

                                            <div class="form-check form-switch">
                                                <input class="form-check-input" type="checkbox" id="darkModeToggle" onchange="toggleDarkMode()">
                                                <label class="form-check-label" for="darkModeToggle">Dark Mode</label>
                                            </div>
                                            <button type="submit" class="btn btn-primary">Save Settings</button>
                                            <button onclick="clearLocalStorage()" class="btn btn-danger">Clear Local Storage</button>
                                        </form>
                                    </div>
                                </div>



                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>


    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h1 class="modal-title fs-5" id="staticBackdropLabel">Modal title</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="adminpro">
              ...
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary">Understood</button>
            </div>
          </div>
        </div>
      </div>





    <footer class="bg-dark text-white text-center py-4 mt-5">
        <div class="container">
            <p class="mb-0">© 2025 Library Management System. All rights reserved.</p>
        </div>
    </footer>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-k6d4wzSIapyDyv1kpU366/PK5hCdSbCRGRCMv+eplOQJWyd1fbcAu9OCUj5zNLiq"
    crossorigin="anonymous"></script>
    <script>
        
// DOM Elements - Authentication
const loginSession = document.getElementById('login');
const signSession = document.getElementById('sign');
const signupdiv = document.getElementById('signupdiv');
const logindiv = document.getElementById('logindiv');
const fname = document.getElementById('fname');
const lname = document.getElementById('lname');
const email = document.getElementById('email');
const pswd = document.getElementById('pswd');
const cpswd = document.getElementById('cpswd');
const loginemail = document.getElementById('loginemail');
const loginpswd = document.getElementById('loginpswd');

// DOM Elements - User Dashboard
const part2 = document.getElementById('part2');
const part3 = document.getElementById('part3');
const userNames = document.getElementById('userNames');
const userSearchInput = document.getElementById('userSearchInput');
const task = document.getElementById('task');
const pagination = document.getElementById('pagination');
const borrowedBooks = document.getElementById('borrowedBooks');
const historyBooks = document.getElementById('historyBooks');
const refreshCatalog = document.getElementById('refreshCatalog');
const editProfileBtns = document.getElementById('editProfileBtns');
const logoutBtn = document.getElementById('logoutBtn');
const Profiles = document.getElementById('Profiles');

// DOM Elements - Admin Dashboard
const amount = document.getElementById('amount');
const totalBooks = document.getElementById('totalBooks');
const totalMembers = document.getElementById('totalMembers');
const booksBorrowed = document.getElementById('booksBorrowed');
const activedueBooks = document.getElementById('activedueBooks');
const recentActivities = document.getElementById('recentActivities');
const adminpro = document.getElementById('adminpro');
const membersTableBody = document.getElementById('membersTableBody');
const booksTableBody = document.getElementById('booksTableBody');

// Load users from localStorage
let users = JSON.parse(localStorage.getItem('user')) || [];

console.log(users);
console.log(users.length);
totalMembers.innerHTML = users.length;



// Toggle between login and signup forms
loginSession.addEventListener('click', () => {
    document.getElementById('signupdiv').style.display = 'none';
    document.getElementById('logindiv').style.display = 'block';
});

signSession.addEventListener('click', () => {
    document.getElementById('signupdiv').style.display = 'block';
    document.getElementById('logindiv').style.display = 'none';
});


// Form validation for signup
fname.addEventListener('keypress', () => {
    if(fname.value.length < 4){
        fname.style.border = '2px solid red';
        document.getElementById('fnameval').innerText = 'Please enter a valid name';
    } else {
        fname.style.border = '2px solid green';
        document.getElementById('fnameval').innerText = '';
    }
});

lname.addEventListener('keypress', () => {
    if (lname.value.length < 4) {
        lname.style.border = '2px solid red';
        document.getElementById('lnameval').innerText = 'Please enter a correct name';
    } else {
        lname.style.border = '2px solid green';
        document.getElementById('lnameval').innerText = '';
    }
});

email.addEventListener('keypress', () => {
    const mailreg = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (mailreg.test(email.value)) {
        email.style.border = '2px solid green';
        document.getElementById('emailval').innerText = '';
    } else {
        email.style.border = '2px solid red';
        document.getElementById('emailval').innerText = 'Invalid email';
    }
});

pswd.addEventListener('keypress', () => {
    if (pswd.value.length >= 6) {
        pswd.style.border = '2px solid green';
        document.getElementById('pasval').innerText = '';
    } else {
        pswd.style.border = '2px solid red';
        document.getElementById('pasval').innerText = 'Password must be at least 6 characters';
    }
});

cpswd.addEventListener('keypress', () => {
    if (pswd.value === cpswd.value) {
        cpswd.style.border = '2px solid green';
        document.getElementById('cpassval').innerText = '';
    } else {
        cpswd.style.border = '2px solid red';
        document.getElementById('cpassval').innerText = 'Passwords do not match';
    }
});

// Save user data to localStorage
function saveToLocalstorage() {
    localStorage.setItem('user', JSON.stringify(users));
}

// Register a new user
function sign() {
    // Creates a new user account and adds to users array
    if(!(fname.value && lname.value && email.value && pswd.value && cpswd.value)){
        alert('Invalid credentials - all fields are required');
        return;
    }
    
    // Check if passwords match
    if(pswd.value !== cpswd.value) {
        alert('Passwords do not match');
        return;
    }
    
    // Check if email already exists
    const emailExists = users.some(user => user.email === email.value);
    if(emailExists) {
        alert('An account with this email already exists');
        return;
    }
    
    // Create new user
    const newUser = {
        firstname: fname.value,
        lastname: lname.value,
        email: email.value,
        password: pswd.value,
        date: new Date().toDateString(),
        borrowedBook: [],
        returnedbook: [],
        wishlistBook: [],
        active: navigator.onLine
    };
    
    // Add user to array
    users.push(newUser);
    
    // Save updated users array
    saveToLocalstorage();
    
    // Store the new user's index
    const newUserIndex = users.length - 1;
    localStorage.setItem('loggedInUserIndex', newUserIndex);
    
    alert('Registration successful! You are now logged in.');

    // Show user dashboard
    document.getElementById('part2').style.display = 'block';
    document.getElementById('signupdiv').style.display = 'none';
    
    // Display user name and borrowed books
    displayUserNames();
    displayBorrowedBooks();
}

// Login user authentication
function Login() {
    // Authenticates user login credentials and directs to appropriate dashboard
    if (loginemail.value === 'otulajafavour14@gmail.com' && loginpswd.value === 'qwerty12345we') {
        alert('login succesfully');
        document.getElementById('part3').style.display = 'block';
        document.getElementById('logindiv').style.display = 'none';
        return;
    }
    console.log(loginemail.value);
    console.log(loginpswd.value);
    
    let foundUserIndex = users.findIndex(user => user.email === loginemail.value && user.password === loginpswd.value);
    if (foundUserIndex !== -1) {

        // Store the logged-in user's index in localStorage for later reference
        localStorage.setItem('loggedInUserIndex', foundUserIndex);
        
        // index position of each users
        if (!users[foundUserIndex].borrowedBook) {
            users[foundUserIndex].borrowedBook = [];
        }
        if (!users[foundUserIndex].returnedbook) {
            users[foundUserIndex].returnedbook = [];
        }
        
        
        // Save any updates to user structure
        saveToLocalstorage();
        
        alert('Login Successfully');
        document.getElementById('part2').style.display = 'block';
        document.getElementById('logindiv').style.display = 'none';
        
        // Display user name on dashboard
        displayUserNames();
        // Display user's borrowed books
        displayBorrowedBooks();
        
        // Update book borrowing statistics
        if (booksBorrowed) {
            booksBorrowed.innerHTML = getTotalBorrowedBooks();
        }
        
        return;
    } else {
        alert('Invalid Email or Password');
    }
}


// Fetch books data from JSON file
async function fetchingData() {
    // Fetches books data from external JSON file
    try {
        const reponse = await fetch('data.json');
        const result = await reponse.json();

        totalBooks.innerHTML = result.novels.length;
        manipulateData(result);

        return result; 
    } catch (error) {
        console.error('error', error);
        return null;
    }
}

// Display books in catalog
function manipulateData(result) {
    // Renders book data in the UI catalog
    // Clear existing content to prevent duplicates
    booksTableBody.innerHTML = '';
    task.innerHTML = '';
    
    result.novels.forEach(novel => {
        console.log(novel);
        let noveldiv = document.createElement('div');
        let row = document.createElement('tr');
        
        // Check if the current user has already borrowed this book
        const loggedInUserIndex = localStorage.getItem('loggedInUserIndex');
        let borrowButtonHtml = `<button class="btn btn-primary borrow-btn" data-book-id="${novel.id}" data-book-title="${novel.title}" data-book-author="${novel.author}" data-book-image="${novel.image}">Borrow Book</button>`;
        
        
        
        noveldiv.innerHTML = `
        <div class="card" style="width: 18rem;">
          <img src="${novel.image}" alt="...">
          <div class="card-body">
            <h5 class="card-title">${novel.author}</h5>
            <p class="card-text">${novel.title}</p>
            <p class="card-text">${novel.genre}</p>
            <p class="card-text">${novel.status}</p>
            <a href="#" class="btn btn-primary">Details</a>
            ${borrowButtonHtml}
          </div>
        </div>
        `;
        row.innerHTML = `
         <td>${novel.id}</td>
          <td>${novel.author}</td>
        <td>${novel.title}</td>
        <td>${novel.genre}</td>
        <td>${novel.status}</td>
        <td>Limited</td>
    
        `;
        booksTableBody.appendChild(row);
        task.appendChild(noveldiv);
    });
    
    // Add event listeners to all borrow buttons
    document.querySelectorAll('.borrow-btn').forEach(button => {
        button.addEventListener('click', function() {
            borrowBook(
                this.getAttribute('data-book-id'),
                this.getAttribute('data-book-title'),
                this.getAttribute('data-book-author'),
                this.getAttribute('data-book-image')
            );
        });
    });
}

// ---------- USER BOOK MANAGEMENT FUNCTIONS ----------





// Borrow a book
function borrowBook(bookId, bookTitle, bookAuthor, bookImage) {
    const loggedInUserIndex = localStorage.getItem('loggedInUserIndex');
    
    if (loggedInUserIndex === null) {
        alert('Please login to borrow books');
        return;
    }
    
    const user = users[parseInt(loggedInUserIndex)];
    
    // Initialize borrowedBook array if it doesn't exist
    if (!user.borrowedBook) {
        user.borrowedBook = [];
    }
    
    // Check if book is already borrowed by this user (handle both formats)
    const isAlreadyBorrowed = user.borrowedBook.some(book => {
        if (typeof book === 'string') {
            return book === bookId;
        } else {
            return book.id === bookId;
        }
    });
    
    if (isAlreadyBorrowed) {
        alert('You have already borrowed this book!');
        return;
    }
    
    // Convert old format (string IDs) to new format (book objects)
    if (user.borrowedBook.some(book => typeof book === 'string')) {
        // If we find any string IDs, convert all to new format
        const convertedBorrowedBooks = [];
        
        // Process existing string IDs asynchronously
        const processExistingBooks = async () => {
            for (const item of user.borrowedBook) {
                if (typeof item === 'string') {
                    const bookDetails = await fetchBookDetails(item);
                    if (bookDetails) {
                        convertedBorrowedBooks.push(bookDetails);
                    }
                } else {
                    convertedBorrowedBooks.push(item);
                }
            }
            
            // Add the new book
            convertedBorrowedBooks.push({
                id: bookId,
                title: bookTitle,
                author: bookAuthor,
                image: bookImage,
                borrowDate: new Date().toLocaleDateString()
            });
            
            
            // Update user's borrowed books with converted list
            user.borrowedBook = convertedBorrowedBooks;
            
            // Save updated user data
            saveToLocalstorage();
            
            // Complete the process
            finalizeBorrowProcess(bookTitle);
        };
        
        processExistingBooks();
    } else {
        // Directly add new book if no conversion needed
        user.borrowedBook.push({
            id: bookId,
            title: bookTitle, 
            author: bookAuthor,
            image: bookImage,
            borrowDate: new Date().toLocaleDateString()
        });
        
        // Save updated user data
        saveToLocalstorage();
        
        // Complete the process
        finalizeBorrowProcess(bookTitle);
    }
}

// Helper function to finalize the borrowing process
function finalizeBorrowProcess(bookTitle) {
    // Update display
    displayUserNames();
    displayBorrowedBooks();
    
    // Update book borrowing statistics
    if (booksBorrowed) {
        booksBorrowed.innerHTML = getTotalBorrowedBooks();
    }
    
    // Show success alert
    alert(`"${bookTitle}" has been borrowed successfully!`);
    
    // Refresh book catalog to show updated borrow status
    fetchingData();
}

// Return a book
function returnBook(bookIndex) {
    const loggedInUserIndex = localStorage.getItem('loggedInUserIndex');
    
    if (loggedInUserIndex === null) {
        alert('Please login to return books');
        return;
    }
    
    const user = users[parseInt(loggedInUserIndex)];
    
    if (!user.borrowedBook || bookIndex >= user.borrowedBook.length) {
        alert('Book not found in your borrowed list');
        return;
    }
    
    // Get book details before removing
    const returnedBook = user.borrowedBook[bookIndex];
    
    // Handle both string IDs and full book objects
    if (typeof returnedBook === 'string') {
        // For old format (just ID strings)
        fetchBookDetails(returnedBook).then(bookDetails => {
            if (bookDetails) {
                completeReturnProcess(user, bookIndex, bookDetails);
            } else {
                alert('Error retrieving book details. Please try again later.');
            }
        });
    } else {
        // For new format (full book objects)
        completeReturnProcess(user, bookIndex, returnedBook);
    }
}

// Helper function to complete the book return process
function completeReturnProcess(user, bookIndex, returnedBook) {
    // Initialize returnedbook array if it doesn't exist
    if (!user.returnedbook) {
        user.returnedbook = [];
    }
    
    // Add to returned books history
    user.returnedbook.push({
        ...returnedBook,
        returnDate: new Date().toLocaleDateString()
    });
    
    // Store the title before removing the book
    const bookTitle = returnedBook.title;
    
    // Remove from borrowed books
    user.borrowedBook.splice(bookIndex, 1);
    
    // Save updated user data
    saveToLocalstorage();
    
    // Update display
    displayUserNames();
    displayBorrowedBooks();
    
    // Update book borrowing statistics
    if (booksBorrowed) {
        booksBorrowed.innerHTML = getTotalBorrowedBooks();
    }
    
    // Show success alert
    alert(`"${bookTitle}" has been returned successfully!`);
    
    // Refresh book catalog to show updated borrow status
    fetchingData();
}

// Display borrowed books for the current user
function displayBorrowedBooks() {
    const borrowedContainer = document.getElementById('borrowedBooks');
    if (!borrowedContainer) {
        console.error('Borrowed books container not found!');
        return;
    }

    const loggedInUserIndex = localStorage.getItem('loggedInUserIndex');

    if (loggedInUserIndex === null) {
        borrowedContainer.innerHTML = '<h3>Borrowed Books</h3><p>Please login to view your borrowed books.</p>';
        return;
    }

    const user = users[parseInt(loggedInUserIndex)];

    // Clear the container before adding content
    borrowedContainer.innerHTML = '<h3>Borrowed Books</h3>';

    // Check if the user has a borrowedBook array
    if (!user.borrowedBook) {
        user.borrowedBook = [];
        saveToLocalstorage();
    }

    // If no books borrowed, show a message
    if (user.borrowedBook.length === 0) {
        borrowedContainer.innerHTML += '<p>No books borrowed yet.</p>';
        return;
    }

    // Create a container for the books
    const booksContainer = document.createElement('div');
    booksContainer.className = 'borrowed-books-container';
    borrowedContainer.appendChild(booksContainer);

    // Add each borrowed book to the container
    user.borrowedBook.forEach((book, index) => {
        const coverUrl = book.image || 'placeholder.jpg';

        const borrowedItem = document.createElement('div');
        borrowedItem.className = 'borrowed-item';
        borrowedItem.innerHTML = `
        <div class="card mb-3 container" style="display-flex;">
            <div class="row g-0">
                <div class="col-md-4">
                    <img src="${coverUrl}" class="img-fluid rounded-start" alt="${book.title}">
                </div>
                <div class="col-md-8">
                    <div class="card-body">
                        <h5 class="card-title">${book.title}</h5>
                        <p class="card-text">${book.author}</p>
                        <p class="card-text"><small class="text-muted">Borrowed on: ${book.borrowDate || 'Unknown date'}</small></p>
                        <button class="btn btn-warning return-btn" data-index="${index}">Return Book</button>
                    </div>
                </div>
            </div>
        </div>
        `;
        booksContainer.appendChild(borrowedItem);

        // Add event listener to the return button
        const returnBtn = borrowedItem.querySelector('.return-btn');
        returnBtn.addEventListener('click', () => {
            returnBook(index);
        });
    });
}
users.forEach((user, userIndex) => {
    if (user.borrowedBook && user.borrowedBook.length > 0) {
        user.borrowedBook.forEach((book, bookIndex) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${user.firstname} ${user.lastname}</td> 
                <td>${book.title}</td>
                <td>${book.author}</td> 
                <td>${book.borrowDate }</td> 
                <td>${navigator.onLine }</td> 
            `;
            document.getElementById('borrowingsTableBody').appendChild(row);
        });
    }
});
    // Add event listeners to return buttons
    setTimeout(() => {
        document.querySelectorAll('.return-btn').forEach(button => {
            button.addEventListener('click', function() {
                const bookIndex = parseInt(this.getAttribute('data-index'));
                returnBook(bookIndex);
            });
        });
    }, 100); // Short timeout to ensure all books are rendered
// }

// Helper function to fetch book details by ID
async function fetchBookDetails(bookId) {
    try {
        const response = await fetch('data.json');
        const data = await response.json();
        
        // Find the book with matching ID
        const book = data.novels.find(novel => novel.id === bookId);
        
        if (book) {
            return {
                id: book.id,
                title: book.title,
                author: book.author,
                image: book.image,
                borrowDate: new Date().toLocaleDateString() // Assuming borrow date is now
            };
        } else {
            console.error(`Book with ID ${bookId} not found`);
            return null;
        }
    } catch (error) {
        console.error('Error fetching book details:', error);
        return null;
    }
}

// Helper function to add a borrowed book to the display
function addBorrowedBookToDisplay(book, index, container) {
    const coverUrl = book.image || 'placeholder.jpg';
    
    const borrowedItem = document.createElement('div');
    borrowedItem.className = 'borrowed-item';
    borrowedItem.innerHTML = `
    <div class="card mb-3 container" style="display-flex;">
        <div class="row g-0">
            <div class="col-md-4">
                <img src="${coverUrl}" class="img-fluid rounded-start" alt="${book.title}">
            </div>
            <div class="col-md-8">
                <div class="card-body">
                    <h5 class="card-title">${book.title}</h5>
                    <p class="card-text">${book.author}</p>
                    <p class="card-text"><small class="text-muted">Borrowed on: ${book.borrowDate || 'Unknown date'}</small></p>
                    <button class="btn btn-warning return-btn" data-index="${index}">Return Book</button>
                </div>
            </div>
        </div>
    </div>
    `;
    container.appendChild(borrowedItem);
}

// Display user name on dashboard
function displayUserNames() {
    // Shows the currently logged in user's name on the dashboard
    const loggedInUserIndex = localStorage.getItem('loggedInUserIndex');
    if (loggedInUserIndex === null) {
        userNames.innerText = 'Welcome, Guest';
        return;
    }
   
    const user = users[parseInt(loggedInUserIndex)];
    userNames.innerText = `Welcome, ${user.firstname} ${user.lastname}`;
    
    // Show user's book statistics
    if (borrowedBooks) {
        user
        borrowedBooks.innerText = user.borrowedBook ? user.borrowedBook.length : 0;

        amount.innerText = user.borrowedBook.length
       
    }
    
    if (historyBooks) {
        console.log(user)
        console.log(user.returnedbook );
       
        
        document.getElementById('hamount').innerText = user.returnedbook.length
    }
    
  
}
console.log(users);

users.forEach(value =>{
    console.log(value);
    
    value.returnedbook.forEach(element => {
    console.log(element, 55);
    console.log(element.title);
    
    
    historyBooks.innerHTML = `${element.title}  `;
});
})

// ---------- ADMIN FUNCTIONS ----------

// Display all users in admin dashboard
function renderUsers() {
    // Displays all registered users in the admin dashboard
    membersTableBody.innerHTML = '';
    recentActivities.innerHTML = '';
    
    users.forEach((user, index) => {
        const row = document.createElement('tr');
        const rows = document.createElement('tr');
        row.innerHTML = `
          <td>${user.firstname}</td>
          <td>${user.lastname}</td>
        <td>${user.email}</td>
        <td>${user.active}</td>
        <td>${user.date}</td>

        <td>
        <button class="btn" onclick="viewUser(${index})">View</button>
        <button class="btn " onclick="editUser(${index})">Edit</button>
        <button class="btn" onclick="deleteUser(${index})">Delete</button>
        </td>
        `;

        rows.innerHTML = `
        <td>${user.firstname}</td>
        <td>${user.lastname}</td>
      <td>${user.email}</td>
      <td>${user.date}</td>
      <td>${user.borrowedBook ? user.borrowedBook.length : 0}</td>
      `;
        membersTableBody.appendChild(row);
        recentActivities.appendChild(rows);
    });
}

// Delete user (admin function)
function deleteUser(index) {
    // Removes a user from the system
    if (confirm('Are you sure ?')) {
        users.splice(index, 1);
        saveToLocalstorage();
        renderUsers();
    }
}

// View user details (admin function)
function viewUser(index) {
    // Displays detailed information about a specific user
    const user = users[index];
    
    const existingModal = document.getElementById('exampleModal');
    if (existingModal) {
        existingModal.remove();
    }

    const modals = `<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Modal title</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
      <p>${user.firstname}</p>
    <p>${user.lastname}</p>
    <p>${user.email}</p>
    <p>${user.active ? 'Online' : 'Offline'}</p>
    <p>${user.date}</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>`;

    document.body.insertAdjacentHTML('beforeend', modals);

    const modal = new bootstrap.Modal(document.getElementById('exampleModal'));
    modal.show();
}

// Edit user profile
function editUser(index) {
    // Opens a modal to edit user information
    const user = users[index];
    console.log(user);

    // Remove any existing modal to avoid duplicates
    const existingModal = document.getElementById('exampleModal');
    if (existingModal) {
        existingModal.remove();
    }

    const modals = `
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title fs-5" id="exampleModalLabel">Edit Profile</h1>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <label for="editFirstname">First Name:</label>
                        <input type="text" id="editFirstname" class="form-control" value="${user.firstname}">
                        <label for="editLastname" class="mt-2">Last Name:</label>
                        <input type="text" id="editLastname" class="form-control" value="${user.lastname}">
                        <label for="editEmail" class="mt-2">Email:</label>
                        <input type="email" id="editEmail" class="form-control" value="${user.email}">
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button onclick="editagain(${index})" type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>`;

    document.body.insertAdjacentHTML('beforeend', modals);

    const modal = new bootstrap.Modal(document.getElementById('exampleModal'));
    modal.show();
}

// Save edited user information
function editagain(index) {
    // Saves updated user information to the system
    const updatedFirstname = document.getElementById('editFirstname').value.trim();
    const updatedLastname = document.getElementById('editLastname').value.trim();
    const updatedEmail = document.getElementById('editEmail').value.trim();

    if (!updatedFirstname || !updatedLastname || !updatedEmail) {
        alert('All fields are required!');
        return;
    }

    users[index].firstname = updatedFirstname;
    users[index].lastname = updatedLastname;
    users[index].email = updatedEmail;

    saveToLocalstorage();

    // renderUsers();
    displayUserNames()
    displayBorrowedBooks()

    const modal = bootstrap.Modal.getInstance(document.getElementById('exampleModal'));
    modal.hide();
    renderUsers()


    document.getElementById('exampleModal').remove();

    alert('Profile updated successfully!');
}

// ---------- DASHBOARD STATISTICS FUNCTIONS ----------

// Get total borrowed books count
function getTotalBorrowedBooks() {
    // Calculates the total number of books borrowed across all users
    const totalBorrowed = users.reduce((total, user) => {
        if (user.borrowedBook && Array.isArray(user.borrowedBook)) {
            return total + user.borrowedBook.length;
        }
        return total;
    }, 0);
    console.log(`Total Borrowed Books: ${totalBorrowed}`);
    return totalBorrowed;
}

// Get count of active users with due books
function activedueBook() {
    // Counts the number of online users who have borrowed books
    const activeUsers = users.filter(user => 
        user.active === true || user.active === 'online' || user.active === navigator.onLine
    );
    
    const activeUsersWithBooks = activeUsers.filter(user => 
        user.borrowedBook && user.borrowedBook.length > 0
    );
    
    return activeUsersWithBooks.length;
}

// ---------- EVENT LISTENERS ----------

// Edit profile button event
document.getElementById('editProfileBtns').addEventListener('click', () => {
    const loggedInUserIndex = localStorage.getItem('loggedInUserIndex');
    if (loggedInUserIndex === null) {
        alert('Please login to edit your profile.');
        return;
    }
    editUser(parseInt(loggedInUserIndex));
});

// Navigation menu events
document.querySelectorAll('.list-group-item').forEach(item => {
    item.addEventListener('click', function (e) {
        e.preventDefault();
        const sections = ['dashboardSection', 'booksSection', 'membersSection', 'borrowingsSection', 'settingsSection'];
        sections.forEach(section => {
            document.getElementById(section).classList.add('d-none');
        });

        const targetSection = this.id.replace('Nav', 'Section');
        document.getElementById(targetSection).classList.remove('d-none');
    });
});

// Logout button event
document.getElementById('logoutBtn').addEventListener('click', function () {
    if (confirm('Are you sure you want to logout?')) {
        localStorage.removeItem('loggedInUserIndex');
        window.location.href = 'login.html';
    }
});

// ---------- INITIALIZATION ----------

// Check if user is logged in and display username
if (localStorage.getItem('loggedInUserIndex') !== null) {
    displayUserNames();
    displayBorrowedBooks();
}

// Initialize statistics displays
booksBorrowed.innerHTML = getTotalBorrowedBooks();
activedueBooks.innerHTML = activedueBook();

// Render users list and fetch books catalog
renderUsers();
fetchingData();

// Add event for refresh catalog button
if (refreshCatalog) {
    refreshCatalog.addEventListener('click', () => {
        fetchingData();
    });
}

function clearLocalStorage() {
    if (confirm('Are you sure you want to clear all data? This action cannot be undone.')) {
        localStorage.clear();
        alert('Local storage has been cleared.');
        window.location.reload(); 
    }
}

function toggleDarkMode() {
    const isDarkMode = document.getElementById('darkModeToggle').checked; // Check if the toggle is checked

    if (isDarkMode) {
        document.body.classList.add('dark-mode'); // Add dark mode class to the body
        localStorage.setItem('darkMode', 'enabled'); // Save preference to local storage
    } else {
        document.body.classList.remove('dark-mode'); // Remove dark mode class from the body
        localStorage.setItem('darkMode', 'disabled'); // Save preference to local storage
    }
}

// Initialize Dark Mode on Page Load
function initializeDarkMode() {
    const darkModePreference = localStorage.getItem('darkMode'); // Get preference from local storage

    if (darkModePreference === 'enabled') {
        document.body.classList.add('dark-mode'); // Enable dark mode
        document.getElementById('darkModeToggle').checked = true; // Set the toggle to checked
    } else {
        document.body.classList.remove('dark-mode'); // Disable dark mode
        document.getElementById('darkModeToggle').checked = false; // Set the toggle to unchecked
    }
}
    </script>
</body>

</html>